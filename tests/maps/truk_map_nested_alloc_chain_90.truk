struct Inner {
  value: i32
}

struct Outer {
  inner: *Inner,
  extra: i32
}

fn main() : i32 {
  var m: map[Outer] = make(@map[Outer]);
  
  var inner_ptr: *Inner = make(@Inner);
  (*inner_ptr).value = 45;
  
  var outer: Outer = Outer{inner: inner_ptr, extra: 45};
  m["data"] = outer;
  
  var ptr: *Outer = m["data"];
  if ptr != nil {
    if (*ptr).inner != nil {
      var result: i32 = (*(*ptr).inner).value + (*ptr).extra;
      delete((*ptr).inner);
      delete(m);
      return result;
    }
  }
  
  delete(m);
  return 0;
}
