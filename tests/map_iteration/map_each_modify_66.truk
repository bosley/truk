fn main() : i32 {
  var m: map[*u8, i32] = make(@map[*u8, i32]);
  m["a"] = 10;
  m["b"] = 20;
  m["c"] = 30;
  
  var dummy: i32 = 0;
  each(m, &dummy, fn(key: *u8, val: *i32, ctx: *i32) : bool {
    if val != nil {
      *val = *val + 2;
    }
    return true;
  });
  
  var sum: i32 = 0;
  var ptr: *i32 = m["a"];
  if ptr != nil {
    sum = sum + *ptr;
  }
  ptr = m["b"];
  if ptr != nil {
    sum = sum + *ptr;
  }
  ptr = m["c"];
  if ptr != nil {
    sum = sum + *ptr;
  }
  
  delete(m);
  return sum;
}